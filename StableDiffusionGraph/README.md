这部分代码来自 [FernNPR](https://github.com/FernRender/FernNPR)